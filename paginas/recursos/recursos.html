<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestión de Recursos Académicos</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="recursos.css" rel="stylesheet">
</head>

<body>
    <div class="d-flex">
        <!-- Sidebar -->
        <div class="bg-dark text-white p-3" id="sidebar">
            <div class="text-center mb-4">
                <img src="../../static/img/fondo_aguilas_saber.png" alt="Logo Maky System" class="img-fluid mb-2" style="max-height: 80px;">
                <h4>Maky System</h4>
            </div>
            <ul class="nav flex-column">
                <li class="nav-item">
                    <a href="../../paginas/pagina_inicio/home.html" class="nav-link text-white">
                        <i class="fas fa-home me-2"></i>Inicio
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#adminSubmenu" class="nav-link text-white" data-bs-toggle="collapse" aria-expanded="false" aria-controls="adminSubmenu">
                        <i class="fas fa-cogs me-2"></i>Administración <i class="fas fa-chevron-down ms-auto"></i>
                    </a>
                    <div class="collapse" id="adminSubmenu">
                        <ul class="nav flex-column ms-3">
                            <li class="nav-item">
                                <a href="../../paginas/usuarios/listado-usuarios.html" class="nav-link">
                                    <i class="fas fa-users me-2"></i>Usuarios
                                </a>
                            </li>
                            <li class="nav-item">
                                <a href="../../paginas/recursos/recursos.html" class="nav-link text-white">
                                    <i class="fas fa-boxes me-2"></i>Recursos
                                </a>
                            </li>
                            <li class="nav-item">
                                <a href="../../paginas/prestamos/prestamos.html" class="nav-link text-white">
                                    <i class="fas fa-archive me-2"></i>Préstamos
                                </a>
                            </li>
                            <li class="nav-item">
                                <a href="../../paginas/devoluciones/devoluciones.html" class="nav-link text-white">
                                    <i class="fas fa-undo me-2"></i>Devoluciones
                                </a>
                            </li>
                            <li class="nav-item">
                                <a href="../../paginas/productos/listado-productos.html" class="nav-link text-white">
                                    <i class="fas fa-shopping-cart me-2"></i>Productos
                                </a>
                            </li>
                            <li class="nav-item">
                                <a href="../../paginas/roles/listado-roles.html" class="nav-link text-white">
                                    <i class="fas fa-user-shield me-2"></i>Gestionar Rol
                                </a>
                            </li>
                            <li class="nav-item">
                                <a href="../../paginas/roles/gestion-permisos.html" class="nav-link text-white">
                                    <i class="fas fa-key me-2"></i>Gestionar Permisos
                                </a>
                            </li>
                            <li class="nav-item">
                                <a href="../../paginas/recursos/estado-recursos.html" class="nav-link text-white">
                                    <i class="fas fa-chart-line me-2"></i>Ver Estado de Recursos
                                </a>
                            </li>
                            <li class="nav-item">
                                <a href="../../paginas/productos/ingreso-productos.html" class="nav-link text-white">
                                    <i class="fas fa-arrow-up me-2"></i>Gestión de Ingresos
                                </a>
                            </li>
                        </ul>
                    </div>
                </li>
            </ul>
            <hr class="text-secondary">
            <a href="../../paginas/index/index.html" class="btn btn-danger w-100">Cerrar sesión</a>
        </div>

        <!-- Main Content -->
        <div class="flex-grow-1 p-4 bg-light">
            <h1 class="h4 mb-2">Gestión de Recursos Académicos</h1>
            <hr style="margin: 0.5rem 0; border: 1px solid rgba(0, 0, 0, 0.1); box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.1);">
            <p class="mt-1">Seleccione una acción para gestionar los recursos académicos.</p>
            <button class="btn btn-success mb-3" data-bs-toggle="modal" data-bs-target="#addResourceModal">Agregar Recurso</button>

            <div class="d-flex justify-content-between mb-3">
                <div class="d-flex align-items-center">
                    <label for="resourcePerPage" class="me-2">Mostrar:</label>
                    <select id="resourcePerPage" class="form-select w-auto">
                        <option value="10">10 Recursos</option>
                        <option value="20">20 Recursos</option>
                    </select>
                </div>
                <div class="input-group w-50">
                    <input type="text" id="searchInput" class="form-control" placeholder="Buscar recursos" oninput="searchResources()">
                    <button class="btn btn-outline-secondary" id="searchButton" onclick="searchResources()">
                        <i class="fas fa-search"></i>
                    </button>
                </div>                
            </div>

            <table class="table table-striped">
                <thead class="table-dark">
                    <tr>
                        <th>#</th>
                        <th>Nombre</th>
                        <th>Descripción</th>
                        <th>Categoría</th>
                        <th>Estado</th>
                        <th>Editar</th>
                        <th>Eliminar</th>
                    </tr>
                </thead>
                <tbody id="resourceTableBody"></tbody>
            </table>

            <nav>
                <ul class="pagination justify-content-center" id="pagination"></ul>
            </nav>
        </div>
    </div>

    <!-- Modal de Agregar Recurso -->
    <div class="modal fade" id="addResourceModal" tabindex="-1" aria-labelledby="addResourceModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="addResourceModalLabel">Agregar Recurso</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
                </div>
                <div class="modal-body">
                    <form id="addResourceForm">
                        <div class="mb-3">
                            <label for="addName" class="form-label">Nombre</label>
                            <input type="text" class="form-control" id="addName" required>
                        </div>
                        <div class="mb-3">
                            <label for="addDescription" class="form-label">Descripción</label>
                            <textarea class="form-control" id="addDescription" required></textarea>
                        </div>
                        <div class="mb-3">
                            <label for="addCategory" class="form-label">Categoría</label>
                            <select class="form-select" id="addCategory" required>
                                <option value="Libros">Libros</option>
                                <option value="Material Digital">Material Digital</option>
                                <option value="Equipos">Equipos</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="addStatus" class="form-label">Estado</label>
                            <select class="form-select" id="addStatus" required>
                                <option value="Disponible">Disponible</option>
                                <option value="No Disponible">No Disponible</option>
                            </select>
                        </div>
                        <button type="submit" class="btn btn-primary">Guardar Recurso</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de Confirmación de Eliminación -->
    <div class="modal fade" id="confirmModal" tabindex="-1" aria-labelledby="confirmModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="confirmModalLabel">Confirmar Eliminación</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
                </div>
                <div class="modal-body">
                    ¿Estás seguro de que deseas eliminar el recurso <span id="resourceNameToDelete"></span>?
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-danger" onclick="deleteResource()">Eliminar</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de Notificación de Éxito -->
    <div class="modal fade" id="successModal" tabindex="-1" aria-labelledby="successModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="successModalLabel">Recurso Eliminado</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
                </div>
                <div class="modal-body">
                    El recurso ha sido eliminado satisfactoriamente.
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" data-bs-dismiss="modal">Aceptar</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de Edición de Recurso -->
    <div class="modal fade" id="editModal" tabindex="-1" aria-labelledby="editModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="editModalLabel">Editar Recurso</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
                </div>
                <div class="modal-body">
                    <form id="editResourceForm">
                        <div class="mb-3">
                            <label for="editName" class="form-label">Nombre</label>
                            <input type="text" class="form-control" id="editName" required>
                        </div>
                        <div class="mb-3">
                            <label for="editDescription" class="form-label">Descripción</label>
                            <textarea class="form-control" id="editDescription" required></textarea>
                        </div>
                        <div class="mb-3">
                            <label for="editCategory" class="form-label">Categoría</label>
                            <select class="form-select" id="editCategory" required>
                                <option value="Libros">Libros</option>
                                <option value="Material Digital">Material Digital</option>
                                <option value="Equipos">Equipos</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="editStatus" class="form-label">Estado</label>
                            <select class="form-select" id="editStatus" required>
                                <option value="Disponible">Disponible</option>
                                <option value="No Disponible">No Disponible</option>
                            </select>
                        </div>
                        <button type="submit" class="btn btn-primary">Guardar Cambios</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <footer id="footer" class="bg-danger text-white text-center py-3 mt-auto">
        © 2024 Maky System. Todos los derechos reservados.
    </footer>

    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js"></script>


<script>
    let resources = [
    { id: 1, name: 'Lápiz', description: 'Lápiz de madera', category: 'Material Digital', status: 'Disponible' },
    { id: 2, name: 'Cuaderno', description: 'Cuaderno cuadriculado de 100 hojas', category: 'Libros', status: 'Disponible' },
    { id: 3, name: 'Goma de borrar', description: 'Goma de borrar de caucho', category: 'Material Digital', status: 'Disponible' },
    { id: 4, name: 'Regla', description: 'Regla plástica de 30 cm', category: 'Equipos', status: 'Disponible' },
    { id: 5, name: 'Sacapuntas', description: 'Sacapuntas manual', category: 'Material Digital', status: 'Disponible' },
    { id: 6, name: 'Marcadores', description: 'Set de marcadores de colores', category: 'Material Digital', status: 'Disponible' },
    { id: 7, name: 'Carpeta', description: 'Carpeta con anillas', category: 'Libros', status: 'Disponible' },
    { id: 8, name: 'Papel', description: 'Paquete de hojas tamaño carta', category: 'Material Digital', status: 'Disponible' },
    { id: 9, name: 'Tijeras', description: 'Tijeras escolares de 14 cm', category: 'Equipos', status: 'Disponible' },
    { id: 10, name: 'Mochila', description: 'Mochila escolar de tela', category: 'Equipos', status: 'Disponible' }
];

    let currentPage = 1;
    let resourcesPerPage = 10;
    let currentResourceId = null;

    // Función para buscar recursos
    function searchResources() {
        const searchValue = document.getElementById("searchInput").value.toLowerCase();
        renderTable(searchValue);
    }

    // Función para renderizar la tabla con los recursos filtrados
    function renderTable(searchQuery = "") {
        const tableBody = document.getElementById("resourceTableBody");
        tableBody.innerHTML = "";

        // Filtrar los recursos por el término de búsqueda
        const filteredResources = resources.filter(resource => {
            return (
                resource.name.toLowerCase().includes(searchQuery) ||
                resource.description.toLowerCase().includes(searchQuery) ||
                resource.category.toLowerCase().includes(searchQuery) ||
                resource.status.toLowerCase().includes(searchQuery)
            );
        });

        // Mostrar los recursos filtrados por página
        const startIndex = (currentPage - 1) * resourcesPerPage;
        const endIndex = startIndex + resourcesPerPage;
        const pageResources = filteredResources.slice(startIndex, endIndex);

        pageResources.forEach(resource => {
            const row = document.createElement("tr");
            row.innerHTML = `
                <td>${resource.id}</td>
                <td>${resource.name}</td>
                <td>${resource.description}</td>
                <td>${resource.category}</td>
                <td>${resource.status}</td>
                <td><i class="fas fa-edit text-primary btn-icon" onclick="openEditModal(${resource.id})"></i></td>
                <td><i class="fas fa-trash-alt text-danger btn-icon" onclick="openDeleteModal(${resource.id}, '${resource.name}')"></i></td>
            `;
            tableBody.appendChild(row);
        });

        renderPagination(filteredResources);
    }

    // Función para renderizar la paginación
    function renderPagination(filteredResources) {
        const pagination = document.getElementById("pagination");
        pagination.innerHTML = "";

        const pageCount = Math.ceil(filteredResources.length / resourcesPerPage);
        for (let i = 1; i <= pageCount; i++) {
            const pageItem = document.createElement("li");
            pageItem.classList.add("page-item");
            pageItem.innerHTML = `<a class="page-link" href="#" onclick="changePage(${i})">${i}</a>`;
            pagination.appendChild(pageItem);
        }
    }

    // Función para cambiar de página
    function changePage(pageNumber) {
        currentPage = pageNumber;
        const searchValue = document.getElementById("searchInput").value.toLowerCase();
        renderTable(searchValue);
    }

    // Función para abrir el modal de eliminar
    function openDeleteModal(id, name) {
        document.getElementById("resourceNameToDelete").innerText = name;
        currentResourceId = id;
        const deleteModal = new bootstrap.Modal(document.getElementById("confirmModal"));
        deleteModal.show();
    }

    // Función para eliminar el recurso
    function deleteResource() {
        resources = resources.filter(resource => resource.id !== currentResourceId);
        renderTable();
        const successModal = new bootstrap.Modal(document.getElementById("successModal"));
        successModal.show();
    }

    // Función para abrir el modal de editar
    function openEditModal(id) {
        currentResourceId = id;
        const resource = resources.find(resource => resource.id === id);
        document.getElementById("editName").value = resource.name;
        document.getElementById("editDescription").value = resource.description;
        document.getElementById("editCategory").value = resource.category;
        document.getElementById("editStatus").value = resource.status;

        const editModal = new bootstrap.Modal(document.getElementById("editModal"));
        editModal.show();
    }

    // Función para agregar un recurso
    document.getElementById("addResourceForm").addEventListener("submit", function (event) {
        event.preventDefault();

        const newResource = {
            id: resources.length + 1,
            name: document.getElementById("addName").value,
            description: document.getElementById("addDescription").value,
            category: document.getElementById("addCategory").value,
            status: document.getElementById("addStatus").value
        };

        resources.push(newResource);
        renderTable();
        const addModal = new bootstrap.Modal(document.getElementById("addResourceModal"));
        addModal.hide();
    });

    // Función para editar un recurso
    document.getElementById("editResourceForm").addEventListener("submit", function (event) {
        event.preventDefault();

        const updatedResource = {
            id: currentResourceId,
            name: document.getElementById("editName").value,
            description: document.getElementById("editDescription").value,
            category: document.getElementById("editCategory").value,
            status: document.getElementById("editStatus").value
        };

        const index = resources.findIndex(resource => resource.id === currentResourceId);
        resources[index] = updatedResource;
        renderTable();
        const editModal = new bootstrap.Modal(document.getElementById("editModal"));
        editModal.hide();
    });

    // Inicialización de la tabla al cargar la página
    renderTable();
</script>